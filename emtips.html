<!DOCTYPE HTML>
<!--
    Massively by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
    <head>
        <title>EM Tipskupong Ställning</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <link rel="stylesheet" href="assets/css/main.css" />
        <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
    <body class="is-preload">

        <!-- Wrapper -->
        <div id="wrapper">

            <!-- Header -->
            <header id="header">
                <a href="index.html" class="logo">EM Tipskupong Ställning</a>
            </header>

            <!-- Nav -->
            <nav id="nav">
                <ul class="links">
                    <li class="active"><a href="index.html">Back to Overview</a></li>
                </ul>
                <ul class="icons">
                    <li><a href="https://www.linkedin.com/in/gustav-nåfält-32716b135" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li>
                    <li><a href="https://github.com/nafalt94" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
                </ul>
            </nav>

            <!-- Main -->
            <div id="main">
                <!-- Post -->
                <section class="post">
                    <header class="major">
                        <span class="date">June, 2024</span>
                        <h1>EM Tipskupong<br/>Ställning</h1>
                        <p>Följ ställningen live för EM-tipsen.</p>
                    </header>
                    <div class="table-wrapper">
                        <h2>Resultat</h2>
                        <table id="resultat-table">
                            <thead>
                                <tr id="resultat-headers">
                                    <!-- Table headers will be inserted here -->
                                </tr>
                            </thead>
                            <tbody id="resultat-body">
                                <!-- Table data will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="table-wrapper">
                        <h2>Kuponger</h2>
                        <table id="kuponger-table">
                            <thead>
                                <tr id="kuponger-headers">
                                    <!-- Table headers will be inserted here -->
                                </tr>
                            </thead>
                            <tbody id="kuponger-body">
                                <!-- Table data will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="table-wrapper">
                        <h2>Poäng Matcher</h2>
                        <table id="poang-matcher-table">
                            <thead>
                                <tr id="poang-matcher-headers">
                                    <!-- Table headers will be inserted here -->
                                </tr>
                            </thead>
                            <tbody id="poang-matcher-body">
                                <!-- Table data will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <h2>Graphs</h2>
                        <canvas id="chart1"></canvas>
                        <canvas id="chart2"></canvas>
                    </div>
                </section>
            </div>

            <!-- Footer -->
            <footer id="footer">
                <section class="split contact">
                    <section class="alt">
                        <h3>Address</h3>
                        <p>Tvedöravägen 4<br />
                            Torna Hällestad, Lund 24745 </p>
                    </section>
                    <section>
                        <h3>Phone</h3>
                        <p><a href="#">(+46) 704936440</a></p>
                    </section>
                    <section>
                        <h3>Email</h3>
                        <p><a href="#">nafalt94@gmail.com</a></p>
                    </section>
                    <section>
                        <h3>Social</h3>
                        <ul class="icons alt">
                            <li><a href="https://www.linkedin.com/in/gustav-nåfält-32716b135" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li>
                            <li><a href="https://github.com/nafalt94" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
                        </ul>
                    </section>
                </section>
            </footer>

            <!-- Copyright -->
            <div id="copyright">
                <ul><li>&copy; Untitled</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li></ul>
            </div>

        </div>

        <!-- Scripts -->
        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/jquery.scrollex.min.js"></script>
        <script src="assets/js/jquery.scrolly.min.js"></script>
        <script src="assets/js/browser.min.js"></script>
        <script src="assets/js/breakpoints.min.js"></script>
        <script src="assets/js/util.js"></script>
        <script src="assets/js/main.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                fetch('data.xlsx')
                    .then(response => response.arrayBuffer())
                    .then(data => {
                        const workbook = XLSX.read(data, { type: 'array' });

                        const sheets = {
                            "Resultat": "resultat",
                            "Kuponger": "kuponger",
                            "Poäng_matcher": "poang-matcher"
                        };

                        Object.entries(sheets).forEach(([sheetName, elementId]) => {
                            const sheet = workbook.Sheets[sheetName];
                            const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

                            const headers = jsonData[0];
                            const tableHeaders = document.getElementById(`${elementId}-headers`);
                            headers.forEach(header => {
                                const th = document.createElement('th');
                                th.textContent = header;
                                tableHeaders.appendChild(th);
                            });

                            const tableBody = document.getElementById(`${elementId}-body`);
                            jsonData.slice(1).forEach(row => {
                                const tr = document.createElement('tr');
                                row.forEach(cell => {
                                    const td = document.createElement('td');
                                    td.textContent = cell;
                                    tr.appendChild(td);
                                });
                                tableBody.appendChild(tr);
                            });
                        });

                        // Assuming that you want to generate charts for "Resultat" and "Kuponger"
                        generateChart(workbook.Sheets["Resultat"], "chart1");
                        generateChart(workbook.Sheets["Kuponger"], "chart2");
                    })
                    .catch(error => console.error('Error fetching or processing Excel file:', error));
            });

            function generateChart(sheet, chartId) {
                const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                const labels = jsonData[0].slice(1);
                const data = jsonData.slice(1).map(row => row.slice(1));
                const datasets = data.map((dataRow, index) => ({
                    label: jsonData[index + 1][0],
                    data: dataRow,
                    borderColor: getRandomColor(),
                    fill: false
                }));

                const ctx = document.getElementById(chartId).getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        title: {
                            display: true,
                            text: 'Chart for ' + chartId
                        },
                        tooltips: {
                            mode: 'index',
                            intersect: false,
                        },
                        hover: {
                            mode: 'nearest',
                            intersect: true
                        },
                        scales: {
                            xAxes: [{
                                display: true,
                                scaleLabel: {
                                    display: true,
                                    labelString: 'Category'
                                }
                            }],
                            yAxes: [{
                                display: true,
                                scaleLabel: {
                                    display: true,
                                    labelString: 'Value'
                                }
                            }]
                        }
                    }
                });
            }

            function getRandomColor() {
                const letters = '0123456789ABCDEF';
                let color = '#';
                for (let i = 0; i < 6; i++) {
                    color += letters[Math.floor(Math.random() * 16)];
                }
                return color;
            }
        </script>
    </body>
</html>
